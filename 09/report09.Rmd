---
title: "GAM Model"
author: "Sergi Carol Laura Cebollero Alex Rodriguez"
date: "December 30, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
library(mgcv)

set.seed(123)
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction
The aim of this lab is to understand the GAM model and get an insight into the fitted model. The lab will consist of two different tasks, the first one will be to create different GAM models and see how well they fit the model. The second one will be to choose the best model according to our criteria.

### Exercise 1

First of all, we are going to read the hirsutism dataset and explore it:

```{r}
hirs <- read.table("hirsutism.dat",header=T, sep="\t",fill=TRUE)
hirs$Treatment <- as.factor(hirs$Treatment)

summary(hirs)
head(hirs)
attach(hirs)

boxplot(hirs[,2:5])
```

We can see from the summary and the boxplots that the FG at the start of the treatment (FGm0) is overall  greater than afterwards, where the patient has received the treatment.

In fact, we can see overall how there is a decrease of the FG as the treatment has an effect on the patient's hirsutism.
```{r}

par(mfrow=c(2,2))
boxplot(hirs[,2]~Treatment,ylim=c(0,30))
boxplot(hirs[,3]~Treatment,ylim=c(0,30))
boxplot(hirs[,4]~Treatment,ylim=c(0,30))
boxplot(hirs[,5]~Treatment,ylim=c(0,30))
par(mfrow=c(1,1))

par(mfrow=c(2,2))
boxplot(hirs[Treatment==0,2:5],ylim=c(0,30))
boxplot(hirs[Treatment==1,2:5],ylim=c(0,30))
boxplot(hirs[Treatment==2,2:5],ylim=c(0,30))
boxplot(hirs[Treatment==3,2:5],ylim=c(0,30))
par(mfrow=c(1,1))
```

Now if we take a look at the boxplots above where we are comparing the FG at different stages (months 0, 3, 6 and 12),
... TODO

We want to create a model that explains the FGm12 in function of the variables that were mesured
at the beginning of the trial.